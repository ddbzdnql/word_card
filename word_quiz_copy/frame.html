<html>
	<head>
		<title>GREWord</title>
		<style>
			.header{
				position: fixed;
				top: 0px;
				right: 0px;
				left: 0px;
				border: 5px solid #A54;
				background-color: #233;
				height: 80px;
			}
			.add{
				position: fixed;
				top: 120px;
				right: 5px;
				width: 300px;
				height: 180px;
				border: none;
				line-height: 24px;	
				padding-left: 6px;
				padding-bottom: 4px;
				font-family: "Trebuchet MS", Helvetica, sans-serif;
				font-size: 17px;
				background-image: url('vulpix.jpg');
				background-position: right top;
				background-size: 120px;
				background-color: white;
				background-repeat: no-repeat;
			}
			.add textarea{
				vertical-align: text-top;
				border: 1.5px solid #888;
			}
			.add input{
				border: 1.5px solid #888;
			}
			.add button{
				font-family: "Courier New";
				width: 180px;
				font-weight: bold;
				font-size: 20px;
				color: white;
				background-color: #233;
				border: none;
				border-top: 3px solid white;
			}
			.logo{
				padding-top: 5px;
				padding-left: 5px;
				font-family: "Arial";
				font-size: 30px;
				color: white;
				font-weight: bold;
			}
			.navg{
				color: #AAA;
			}
			.navg ul{
				list-style: none;
				float: right;
			}
			.navg ul li{
				float: left;
				list-style: none;
				padding-right: 10px;
			}
			.show{
				padding-top: 80px;
				width: 1100px;
			}
			.sticker{
				vertical-align: top;
				display: inline-block;
				width: 280px;
				height: 280px;
				font-family: "Courier New";
				font-size: 17px;
				color: white;
				margin: 15px;
				padding-left: 10px;
				padding-right: 10px;
				padding-top: 18px;
				border: 2px solid #888;
			}
			.sticker button{
				border: none;
				font-family: "Arial";
				font-size: 18px;
				text-align: middle;
				color: white;
				background: none;
				border: 1px solid white;
			}
			.content{
				display: inline-block;
				margin: 3px;
				padding-left: 10px
			}
			.sticker_un {
				vertical-align: top;
				display: inline-block;
				width: 280px;
				height: 280px;
				font-family: "Courier New";
				font-size: 40px;
				color: white;
				margin: 15px;
				padding-left: 10px;
				padding-right: 10px;
				padding-top: 18px;
				vertical-align: middle;
				background-color: black;
				background-image: url('2.png');
				background-size: 298px;
				background-position: bottom;
				background-repeat: no-repeat;
				border: 2px solid #888;
			}
			.sticker_st{
				vertical-align: top;
				display: inline-block;
				width: 280px;
				height: 280px;
				font-family: "Courier New";
				font-size: 40px;
				color: red;
				margin: 15px;
				padding-left: 10px;
				padding-right: 10px;
				padding-top: 18px;
				vertical-align: middle;
				background-color: black;
				background-image: url('rose1.png');
				background-size: 298px;
				background-position: bottom;
				background-repeat: no-repeat;
				border: 2px solid red;
			}
			.stat{
				position: fixed;
				right: 5px;
				width: 130px;
				height: 180px;
				background-image: url('flareon.png');
				background-position: left bottom;
				background-size: 170px;
				background-repeat: no-repeat;
				top: 325px;
				padding-left: 170px;
				font-family: "Arial";
				font-size: 23px;
				font-weight: bold;
				vertical-align: middle;
			}
			.stat div{
				font-family: "Courier New";
				font-size: 19px;
				padding-left: 5px;
			}
			.stat button{
				text-decoration: inherit;
				font-family: Impact, Charcoal, sans-serif;
				font-size: 19px;
				border: none;
				background: none;
			}
			.jump{
				position: fixed;
				width: 130px;
				height: 180px;
				right: 5px;
				top: 530px;
				background-image: url('jump.png');
				background-position: top;
				background-repeat: no-repeat;
				background-size: 170px;
				padding-right: 170px;
				font-size: 18px;
				font-family: "Arial";
				text-align: center;
			}
			.jump a{
				text-decoration: none;
				text-align: left;
				padding-right: 7px;
				font-size: 14px;
				color: #876;
				font-weight: bold;
				font-family: "Courier New";
			}
		</style>
	</head>
	<body>
		<div id="header" class="header">
			<div class="logo">
				BR-4759 MANUAL PAGE
			</div>
			<div class="navg"><ul>
					<li>Home  </li><li>Quiz  </li><li>Debug  </li>
				</ul>
			</div>
		</div>
		<div id="stat" class="stat">
		</div>
		<div id="jump" class="jump">
		</div>
		<br />
		<div id="add" class="add">Add a new word?<br/>
			Word: <br/>
			<input type="text" id="add1_word"><br/>
			Definition: <br/>
			<textarea id="add1_def"></textarea><br/>
			<button type="button" id="add_submit" onclick="addWord()">Input a word</button>
		</div>
		<div id="show" class="show"></div>
		<script>
			var disp = "Total";
			var limi = 30;
			var action = "";
			function extract(){
				var a = window.location.href;
				var count = 0;
				var flag = 0;
				var page = 0;
				while(a[count]){
					if (flag){
						page = page * 10 + (a[count] - '0');
					}
					if (a[count] == '='){
						flag = 1;
					}
					count++;
				}
				if (page == 0){
					return 1;
				}
				return page;
			}
			var page = extract();
			console.log(page);
			var length = 0;
			var pageE = (page-1) * limi;
			var arr1 = new Array();
			var arr2 = new Array();
			var arr3 = new Array();
			var arr4 = new Array();
			var co = 0;
			while(co < 61){
				arr3[co] = 1;
				co++;
			}
			var flip = 0;
			var page = "main";
			var res = "";
			function generateRequest(){
				var toRet;
				try{
					toRet = new XMLHttpRequest();
				}
				catch(e1){
					try{
						toRet = new ActiveXObject("Msxm12.XMLHTTP");
					}
					catch(e2){
						try{
							toRet = new ActiveXObject("Microsoft.XMLHTTP");
						}
						catch(e3){
							toRet = false;
						}
					}
				}
				return toRet;
			}
			function cutPage(total){
				var divObj = document.getElementById('jump');
				divObj.innerHTML = "<div id = 'pag' style='width: 300px;padding-top:180px; text-align: left'>Go to page:<br/></div>";
				var count = 1;
				var divObj1 = document.getElementById('pag');
				while(count <= total){
					if (count < 10){
						tmp = '0' + count;
						count = tmp;
					}	
					divObj1.innerHTML += ("<a href='/project/word_quiz_copy/frame.html?page="+count+"'>"+count);
					divObj1.innerHTML += "</a>";
					if (count % 12 == 0){
						divObj1.innerHTML += "<br/>";
					}
					count++;
				}
			}
			function filter(curB){
				disp = curB.innerHTML;
				showFilter(disp);
			}
			function update(){
				var sttObj = document.getElementById('stat');
				sttObj.innerHTML = "";
				var count = 0, learned = 0;
				while(count < arr4.length){
					if (arr4[count] == 1){
						learned ++;
					}
					count++;
				}
				sttObj.innerHTML += "<button>Total</button> <div>"+(arr1.length-1)+" words</div>";
				if (disp != 'Unlearned'){
					sttObj.innerHTML += "<button>Learned</button> <div>"+learned+" words</div>";
				}
				if (disp != 'Learned'){
					sttObj.innerHTML += "<button>Unlearned</button> <div>"+ (arr1.length - learned - 1) +" words</div>";
				}
						
			}
			var cut = 1;
			var stt = 1;
			function showRequest(act){
				var ajReq = generateRequest();
				var res;
				var str = "";
				str += "page="+page+"&act="+act;
				ajReq.onreadystatechange = function(){
					if (this.readyState == 4 && this.status == 200){
						res = this.responseText;
						if (action == "show" && act != "init"){
							arr1 = res.split("SPLIT");
							var count = 0;
							while(arr1[count]){
								var coun = 40;
								var flag = 0;
								var word = "";
								while(arr1[count][coun] != '<'){
									if (flag){
										word += arr1[count][coun];
									}
									if (arr1[count][coun] == ' '){
										flag = 1;
									}
								coun++;
								}		
								arr2[count] = word;
								count++;
							}
							
							var length = Math.floor(arr1.length / limi) + 1;
							if (cut == 1){
								cutPage(length);
								cut = 0;
							}
							count = 0;
							var divObj = document.getElementById("show");
							divObj.innerHTML = "";
							while(arr1[count+pageE] && count < limi){
								if (arr3[count] == 1){
									divObj.innerHTML += "<div class='sticker' onclick='flipCard(this)' id='cont"+count+"'>"+arr1[count+pageE]+"</div>";
									if (arr4[count+pageE] == 1){
										document.getElementById('cont'+count).style.background = "#77C";
									}
									else{
										document.getElementById('cont'+count).style.background = "#B66";
									}
								}
								else{
									if (arr4[count+pageE] == 1){
										divObj.innerHTML += "<div class='sticker_un' onclick='flipCard(this)' id='cont"+count+"'>"+arr2[count+pageE]+"</div>";
									}
									else{
										divObj.innerHTML += "<div class='sticker_st' onclick='flipCard(this)' id='cont"+count+"'>"+arr2[count+pageE]+"</div>"	
									}
								}
								count ++;
							}
							if (stt == 1){
								update();
							}
								
						}
						if (act == "init"){
							arr4 = res.split("SPLIT");
							var i = 0;
						}		
										
					}
				}
				ajReq.open("GET", "response.inc.php?"+str, true);
				ajReq.send();
			}
			function show(){
				init();
				init();
				action = "show";
				showRequest("show&filt=Total");
			}
			function showFilter(filt){
				action = "show";
				showRequest("show&filt="+filt);
			}
			function init(){
				showRequest("init");
			}
			function mark(id, word){
				action = "mark"
				showRequest("mark&word="+word);
				if (arr4[id-1] == 0){
					arr4[id-1] = 1;
				}
				else{
					arr4[id-1] = 0;
				}
				var divObj = document.getElementById('cont'+(id-1-pageE));
				flipCard(divObj);
				console.log("mark"+'star_'+id);
				update();	
			}
			function del(id, word){
				action = "del";
				showRequest("del&word="+word);
				show();
				show();
			}
			function addWord(){
				action = "add";
				var tosen = "add&word="+document.getElementById('add1_word').value
					+"&def="+document.getElementById('add1_def').value;
				document.getElementById('add1_word').value = "";
				document.getElementById('add1_def').value = "";
				showRequest(tosen);
				show();
				show();
			}
			function flipCard(divObj){
				var count = 0;
				
				var id = divObj.id;
				var index = 0;
				console.log(id);
				while( count < id.length){
					if (id[count] >= '0' && id[count] <= '9'){
						index = index * 10 + (id[count] - '0');
					}
					count++;
				}
				index += pageE;
				console.log(index);
				if (arr3[index] == 0){
					arr3[index] = 1;
					divObj.className = "sticker";
					divObj.innerHTML = arr1[index];
					if (arr4[index] == 1){
						document.getElementById('star_'+(index+1)).innerHTML = 'learned.';	
						divObj.style.background = "#77C";
					}
					else{
						document.getElementById('star_'+(index+1)).innerHTML = 'not learned.';
						divObj.style.background = "#B66";
					}
				}
				else{
					arr3[index] = 0;
					divObj.innerHTML = arr2[index];
					divObj.style="";
					if (arr4[index] == 1){
						divObj.className = "sticker_un";
					}
					else{
						divObj.className = "sticker_st";
					}
				}
			}
			console.log("script!");
			show();
			co = 0;
			while(co < 151){
				arr3[co] = 0;
				co++;
			}
			show();
			show();
		</script>	
	</body>
</html>
